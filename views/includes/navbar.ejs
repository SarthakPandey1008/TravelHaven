
<nav class="navbar navbar-expand-md bg-body-light border-bottom sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="/listings" title="TravelHaven Home"><img src="/android-chrome-192x192.png" class="icon"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-link" href="/listings" title="TravelHaven Home">Explore</a>
        </div>
        <div class="navbar-nav ms-auto">
          <form   id="search-form" class="d-flex" role="search" action="/listings/search" method="GET">
            <!-- Search input with a fallback for undefined searchQuery -->
            <input 
              class="form-control me-2 search-inp searchinput" 
              type="search" 
              name="query" 
              placeholder="Search destinations" 
              aria-label="Search" 
              value="<%= typeof searchQuery !== 'undefined' ? searchQuery : '' %>"> 
            <button class="btn search-btn" type="submit" title="Search">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
          </form>
        </div>
        
        <div class="navbar-nav ms-auto">
          <a class="nav-link" href="/listings/new"><b>List Your Place</b></a>
          <% if (!currUser) { %>
            <a class="nav-link" href="/signup"><b>Signup</b></a>
            <a class="nav-link" href="/login"><b style="color: green">Log in</b></a>
          <% } else if (currUser) { %>
            <a class="nav-link" href="/logout"><b style="color: red">Log out</b></a>
          <% } %>
        </div>
      </div>
    </div>
  </nav>
  
    <script>
// document.querySelector('form[role="search"]').addEventListener('submit', function(event) {
//     const input = document.querySelector('input[name="query"]');
//     if (input.value.trim() === '') {
//         event.preventDefault(); // Prevent form submission
//     }
// });


// Store the collapse state before the form is submitted
document.getElementById('search-form').addEventListener('submit', function(event) {
    const input = document.querySelector('input[name="query"]');
    
    if (input.value.trim() === '') {
        event.preventDefault(); // Prevent form submission if input is empty
    } else {
        // If the navbar is collapsed (not shown), store it in sessionStorage
        const navbarCollapse = document.getElementById('navbarNavAltMarkup');
        const isCollapsed = navbarCollapse.classList.contains('show'); // If navbar is collapsed
        sessionStorage.setItem('navbarCollapsed', isCollapsed);
    }
});

// Restore navbar state after search
window.addEventListener('load', function() {
    const navbarCollapse = document.getElementById('navbarNavAltMarkup');
    const wasCollapsed = sessionStorage.getItem('navbarCollapsed') === 'true';
    
    if (wasCollapsed) {
        // Add 'show' class to navbar if it was open before the search
        navbarCollapse.classList.add('show');
    }
});


</script>
