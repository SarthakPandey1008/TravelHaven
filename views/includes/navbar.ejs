
<nav class="navbar navbar-expand-md bg-body-light border-bottom sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="/listings" title="TravelHaven Home"><img src="/android-chrome-192x192.png" class="icon"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-link" href="/listings" title="TravelHaven Home">Explore</a>
        </div>
        <div class="navbar-nav ms-auto">
          <form class="d-flex" role="search" action="/listings/search" method="GET">
            <!-- Search input with a fallback for undefined searchQuery -->
            <input 
              class="form-control me-2 search-inp searchinput" 
              type="search" 
              name="query" 
              placeholder="Search destinations" 
              aria-label="Search" 
              value="<%= typeof searchQuery !== 'undefined' ? searchQuery : '' %>"> 
            <button class="btn search-btn" type="submit" title="Search">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
          </form>
        </div>
        
        <div class="navbar-nav ms-auto">
          <a class="nav-link" href="/listings/new"><b>List Your Place</b></a>
          <% if (!currUser) { %>
            <a class="nav-link" href="/signup"><b>Signup</b></a>
            <a class="nav-link" href="/login"><b style="color: green">Log in</b></a>
          <% } else if (currUser) { %>
            <!-- <a class="nav-link" href="/logout"><b style="color: red">Log out</b></a> -->
            <div  class="navbtn" style="position: relative; display: flex;">
          
              <a  id="optionsButton" class="circular-button" title="<%=currUser.username%>" style="text-decoration: none;"><%=currUser.username.charAt(0).toUpperCase()%></a>  
              <div id="optionsCard" class="card" style="display: none;">
              <ul class="list-group list-group-flush">
                <a href="/logout" id="logout">
                  <li class="list-group-item">Logout</li>
              </a>
              </ul>
          </div>
      </div>
            
          <% } %>
        </div>
      </div>
    </div>
  </nav>
  
    <script>
document.querySelector('form[role="search"]').addEventListener('submit', function(event) {
    const input = document.querySelector('input[name="query"]');
    if (input.value.trim() === '') {
        event.preventDefault(); // Prevent form submission
    }
});

const optionsButton = document.getElementById('optionsButton');
const optionsCard = document.getElementById('optionsCard');

// Toggle card visibility on button click
optionsButton.addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent click from bubbling to the document
    if (optionsCard.style.display === 'none' || optionsCard.style.display === '') {
        optionsCard.style.display = 'flex';
    } else {
        optionsCard.style.display = 'none';
    }
});

// Hide card when clicking outside of it
document.addEventListener('click', () => {
    optionsCard.style.display = 'none';
});

// Prevent card from hiding when clicking inside the card
optionsCard.addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent click from bubbling to the document
});

</script>
